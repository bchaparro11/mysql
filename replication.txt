sudo apt update
sudo apt install mysql-server

sudo systemctl status mysql.service
sudo systemctl start mysql.service

sudo mysql

ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'pass';

sudo mysql_secure_installation

Test
pass
N
N
N
N
N
Y

Production
pass
Y
N
Y
Y
Y
Y

sudo mysql -u root -p

3306



sudo systemctl stop mysql
sudo apt-get purge mysql-server mysql-client mysql-common mysql-server-core-* mysql-client-core-*
sudo rm -rf /etc/mysql /var/lib/mysql
sudo apt autoremove
sudo apt autoclean


create user 'repl'@'%' identified by 'pass';
grant replication slave on *.* to 'repl'@'%';
create database petss;
create table petss.cats (name varchar(20));
insert into petss.cats values ("bow");select * from petss.cats;

sudo -i
mysqldump -uroot --all-databases --master-data > masterdump.sql
grep CHANGE *sql | head -1

CHANGE MASTER TO MASTER_HOST='34.28.215.187', MASTER_USER='repl', MASTER_PASSWORD='pass';
start slave;
show slave status;

Master 2 192.168.6.133
Master 1 192.168.6.134



MASTER
------
apt install mysql-server mysql-client -y
systemctl restart mysql

create user 'rep'@'%' identified by 'pass';
grant replication slave on *.* to 'rep'@'%';
flush privileges;
show master status;

SELECT user, host, plugin FROM mysql.user WHERE user = 'rep';
ALTER USER 'rep'@'%' IDENTIFIED WITH 'mysql_native_password' BY 'pass';


SLAVE
-----
apt install mysql-server mysql-client -y
systemctl restart mysql

stop slave;

CHANGE MASTER TO MASTER_HOST='10.128.0.20', MASTER_USER='rep', MASTER_PASSWORD='pass';

CHANGE MASTER TO MASTER_HOST='10.128.0.20', MASTER_USER='rep', MASTER_PASSWORD='pass', MASTER_LOG_FILE='mysql-bin.000002', MASTER_LOG_POS=1302;

start slave;

MASTER
-----
UNLOCK TABLES;

create database petss;
create table petss.cats (name varchar(20));
insert into petss.cats values ("wow");
select * from petss.cats;